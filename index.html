<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bonikbarta Combined Feed</title>
</head>
<body>
<h1>Bonikbarta Combined Latest Posts</h1>
<ul id="posts"></ul>

<script>
const apiURLs = [
  "https://bonikbarta.com/api/post-filters/41?root_path=00000000010000000001",
  "https://bonikbarta.com/api/post-filters/52?root_path=00000000010000000001"
];
const baseURL = "https://bonikbarta.com";

async function fetchAll() {
  let allItems = [];

  for (let url of apiURLs) {
    try {
      const response = await fetch("https://api.allorigins.win/raw?url=" + encodeURIComponent(url));
      const data = await response.json();
      const items = data.posts || [];
      allItems = allItems.concat(items);
    } catch (err) {
      console.error("Failed to load from", url, err);
    }
  }

  allItems.sort((a, b) => new Date(b.first_published_at) - new Date(a.first_published_at));

  const postList = document.getElementById("posts");

  if (allItems.length === 0) {
    postList.textContent = "âŒ No posts found.";
    return;
  }

  allItems.forEach(item => {
    const li = document.createElement("li");

    // Title link
    const a = document.createElement("a");
    a.textContent = item.title || "No title";
    a.href = baseURL + (item.url_path || "/");
    a.target = "_blank";
    li.appendChild(a);

    // Publication date
    if (item.first_published_at) {
      const span = document.createElement("span");
      span.textContent = " - " + new Date(item.first_published_at).toLocaleDateString();
      li.appendChild(span);
    }

    // Summary / snippet
    if (item.summary) {
      const p = document.createElement("p");
      p.textContent = item.summary;
      li.appendChild(p);
    }

    postList.appendChild(li);
  });
}

fetchAll();
</script>
</body>
</html>
